(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{"3b16":function(t,e,i){"use strict";var n=i("5530"),a=(i("a9e3"),i("0481"),i("caad"),i("2b0e")),s=i("9c40"),r=i("27f9"),o=i("b7fa"),l=i("87e8"),u=i("d882"),c=i("7937"),h=i("d728"),d=i("0cd3");e["a"]=a["a"].extend({name:"QPagination",mixins:[o["a"],l["a"]],props:{value:{type:Number,required:!0},min:{type:Number,default:1},max:{type:Number,required:!0},color:{type:String,default:"primary"},textColor:String,activeColor:String,activeTextColor:String,inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},maxPages:{type:Number,default:0,validator:function(t){return t>=0}},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,dense:Boolean,padding:{type:String,default:"3px 2px"}},data:function(){return{newPage:null}},watch:{min:function(){this.model=this.value},max:function(){this.model=this.value}},computed:{model:{get:function(){return this.value},set:function(t){if(t=parseInt(t,10),!this.disable&&!isNaN(t)){var e=Object(c["a"])(t,this.min,this.max);this.$emit("input",e)}}},inputPlaceholder:function(){return this.model+" / "+this.max},__boundaryLinks:function(){return this.__getBool(this.boundaryLinks,this.input)},__boundaryNumbers:function(){return this.__getBool(this.boundaryNumbers,!this.input)},__directionLinks:function(){return this.__getBool(this.directionLinks,this.input)},__ellipses:function(){return this.__getBool(this.ellipses,!this.input)},icons:function(){var t=[this.iconFirst||this.$q.iconSet.pagination.first,this.iconPrev||this.$q.iconSet.pagination.prev,this.iconNext||this.$q.iconSet.pagination.next,this.iconLast||this.$q.iconSet.pagination.last];return!0===this.$q.lang.rtl?t.reverse():t},attrs:function(){if(!0===this.disable)return{"aria-disabled":"true"}},btnProps:function(){return{round:this.round,rounded:this.rounded,outline:this.outline,unelevated:this.unelevated,push:this.push,glossy:this.glossy,dense:this.dense,padding:this.padding,color:this.color,flat:!0,size:this.size,ripple:null===this.ripple||this.ripple}},activeBtnProps:function(){return{flat:this.flat,color:this.activeColor||this.color,textColor:this.activeTextColor||this.textColor}}},methods:{set:function(t){this.model=t},setByOffset:function(t){this.model=this.model+t},__update:function(){this.model=this.newPage,this.newPage=null},__getBool:function(t,e){return[!0,!1].includes(t)?t:e},__getBtn:function(t,e,i,a){var r=this;return e.props=Object(n["a"])(Object(n["a"])({},this.btnProps),i),void 0!==a&&(void 0!==this.toFn?e.props.to=this.toFn(a):e.on={click:function(){return r.set(a)}}),t(s["a"],e)}},render:function(t){var e=this,i=[],a=[],s=[];if(this.__boundaryLinks&&(i.push(this.__getBtn(t,{key:"bls"},{disable:this.disable||this.value<=this.min,icon:this.icons[0]},this.min)),a.unshift(this.__getBtn(t,{key:"ble"},{disable:this.disable||this.value>=this.max,icon:this.icons[3]},this.max))),this.__directionLinks&&(i.push(this.__getBtn(t,{key:"bdp"},{disable:this.disable||this.value<=this.min,icon:this.icons[1]},this.value-1)),a.unshift(this.__getBtn(t,{key:"bdn"},{disable:this.disable||this.value>=this.max,icon:this.icons[2]},this.value+1))),!0===this.input)s.push(t(r["a"],{staticClass:"inline",style:{width:"".concat(this.inputPlaceholder.length/1.5,"em")},props:{type:"number",dense:!0,value:this.newPage,disable:this.disable,dark:this.isDark,borderless:!0,inputClass:this.inputClass,inputStyle:this.inputStyle},attrs:{placeholder:this.inputPlaceholder,min:this.min,max:this.max},on:Object(d["b"])(this,"inp",{input:function(t){e.newPage=t},keyup:function(t){!0===Object(h["a"])(t,13)&&e.__update()},blur:this.__update})}));else{var o=Math.max(this.maxPages,1+(this.__ellipses?2:0)+(this.__boundaryNumbers?2:0)),l=this.min,c=this.max,p=!1,m=!1,b=!1,f=!1;this.maxPages&&o<this.max-this.min+1&&(o=1+2*Math.floor(o/2),l=Math.max(this.min,Math.min(this.max-o+1,this.value-Math.floor(o/2))),c=Math.min(this.max,l+o-1),this.__boundaryNumbers&&(b=!0,l+=1),this.__ellipses&&l>this.min+(this.__boundaryNumbers?1:0)&&(p=!0,l+=1),this.__boundaryNumbers&&(f=!0,c-=1),this.__ellipses&&c<this.max-(this.__boundaryNumbers?1:0)&&(m=!0,c-=1));var g={minWidth:"".concat(Math.max(2,String(this.max).length),"em")};if(b){var v=this.min===this.value,_={disable:this.disable,flat:!v,label:this.min};v&&(_.color=this.activeColor||this.color,_.textColor=this.activeTextColor||this.textColor),i.push(this.__getBtn(t,{key:"bns",style:g},_,this.min))}if(f){var x=this.max===this.value,y={disable:this.disable,flat:!x,label:this.max};x&&(y.color=this.activeColor||this.color,y.textColor=this.activeTextColor||this.textColor),a.unshift(this.__getBtn(t,{key:"bne",style:g},y,this.max))}p&&i.push(this.__getBtn(t,{key:"bes",style:g},{disable:this.disable,label:"…",ripple:!1},l-1)),m&&a.unshift(this.__getBtn(t,{key:"bee",style:g},{disable:this.disable,label:"…",ripple:!1},c+1));for(var k=l;k<=c;k++){var w={disable:this.disable,flat:!0,label:k};k===this.value&&Object.assign(w,this.activeBtnProps),s.push(this.__getBtn(t,{key:"bpg".concat(k),style:g},w,k))}}return t("div",{staticClass:"q-pagination row no-wrap items-center",class:{disabled:this.disable},attrs:this.attrs,on:Object(n["a"])({},this.qListeners)},[i,t("div",{staticClass:"row justify-center",on:!0===this.input?Object(d["b"])(this,"stop",{input:u["k"]}):null},[s]),a])}})},b789:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"Cart"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row",attrs:{bordered:""}},[i("div",{staticClass:"col text-right"},[i("h4",{staticClass:"text-left"},[t._v("購物車")]),i("q-table",{attrs:{flat:"",bordered:"",data:t.cart,columns:t.columns,"row-key":"name",pagination:t.pagination,"hide-pagination":""},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"body-cell-image",fn:function(t){return[i("q-td",{attrs:{props:t}},[i("img",{staticStyle:{height:"50px"},attrs:{src:t.row.image}})])]}},{key:"body-cell-amount",fn:function(e){return[i("q-td",{attrs:{props:e}},[i("q-input",{attrs:{type:"number",rules:[function(t){return t>0||"數量至少一個"}]},model:{value:e.row.amount,callback:function(i){t.$set(e.row,"amount",i)},expression:"props.row.amount"}})],1)]}},{key:"body-cell-action",fn:function(e){return[i("q-td",{attrs:{props:e}},[i("q-btn",{attrs:{icon:"clear",color:"primary"},on:{click:function(i){return t.delProduct(e.rowIndex)}}})],1)]}}])}),i("div",{staticClass:"row justify-center q-mt-md"},[i("q-pagination",{attrs:{max:t.pagesNumber,color:"grey-8",size:"sm"},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}})],1),i("p",[t._v("總金額"+t._s(t.totalprice))]),i("q-btn",{attrs:{label:"確定購買",color:"primary"},on:{click:t.checkout}})],1)])])])},a=[],s=i("5530"),r=i("1da1"),o=(i("96cf"),i("a434"),i("d81d"),i("99af"),{name:"Cart",data:function(){return{cart:[],columns:[{name:"image",field:"image",align:"center",label:"圖片"},{name:"name",field:"name",align:"center",label:"名稱"},{name:"price",field:"price",align:"center",label:"單價"},{name:"amount",field:"amount",align:"center",label:"數量"},{name:"action",field:"action",align:"center",label:"操作"}],pagination:{sortBy:"image",descending:!1,page:1,rowsPerPage:5}}},methods:{delProduct:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,e.axios.patch("/users/cart",{product:e.cart[t]._id,amount:0},{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:e.cart.splice(t,1),i.next=9;break;case 6:i.prev=6,i.t0=i["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"刪除商品失敗"});case 9:case"end":return i.stop()}}),i,null,[[0,6]])})))()},checkout:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.post("/users/checkout",{},{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 3:t.$swal({icon:"success",title:"成功",text:"感謝購買"}),t.$router.push("/userinfo/order"),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"結帳失敗"});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},computed:{pagesNumber:function(){return Math.ceil(this.cart.length/this.pagination.rowsPerPage)},totalprice:function(){return 0===this.cart.length?0:this.cart.reduce((function(t,e){return t+e.amount*e.price}),0)}},mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.get("/users/cart",{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 3:i=e.sent,n=i.data,t.cart=n.result.map((function(t){return t=Object(s["a"])(Object(s["a"])({},t.product),{},{amount:t.amount}),t.image="".concat("","/files/").concat(t.image),t.edit=!1,t.amountModel=t.amount,t})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得購物車失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}),l=o,u=i("2877"),c=i("eaac"),h=i("db86"),d=i("27f9"),p=i("9c40"),m=i("3b16"),b=i("93dc"),f=i.n(b),g=Object(u["a"])(l,n,a,!1,null,null,null);e["default"]=g.exports;f()(g,"components",{QTable:c["a"],QTd:h["a"],QInput:d["a"],QBtn:p["a"],QPagination:m["a"]})}}]);
//# sourceMappingURL=cart.750fe4eb.js.map